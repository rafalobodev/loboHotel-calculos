<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Calculadora de Descontos e Taxas</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            margin: 20px;
        }
        h2 {
            color: rgb(192, 196, 3); /* Aqui voc√™ pode usar o nome da cor, um c√≥digo hexadecimal (#ff0000), ou RGB */
        }
        .container {
            display: flex;
            align-items: center;
            gap: 10px; /* Espa√ßamento entre o t√≠tulo e o input */
        }
        table {
            border-collapse: collapse;
            width: 100%;
            font-size: 14px;
        }
        th, td {
            border: 1px solid black;
            text-align: center;
            padding: 5px;
        }
        th {
            background-color: #f4f4f4;
        }
        #valorInput {
            width: 60px;
            text-align: center;
            color: purple; /* Cor do texto */
            border: 2px solid purple; /* Borda roxa */
            border-radius: 5px; /* Cantos arredondados */
        }
        input {
            width: 60px;
            text-align: center;
            font-size: 14px;
        }
        .resultado {
            background-color: #fdf4c7;
        }
        button {
            margin-top: 10px;
            padding: 5px 10px;
            font-size: 14px;
        }
        #resultado-final, #resultado-descontos {
            margin-top: 20px;
            font-family: 'Courier New', Courier, monospace;
            white-space: pre-wrap;
            font-size: 14px;
            border: 1px solid black;
            padding: 10px;
            background-color: #f9f9f9;
        }
        #meuBotao {
            background-color: rgb(110, 207, 227); /* Cor de fundo */
        }

        #meuBotao:hover {
            background-color: #06ccda; /* Mudan√ßa de cor ao passar o mouse */
        }
        #meuBotao:active {
            background-color: #a0e6f1; /* Cor mais clara ao clicar */
        }
        #atualizarPagina {
            cursor: pointer;
        }
    </style>
</head>
<body>
    <!-- <h2>Calculadora de 4 Valores 15%</h2> -->
    <div class="container">
        <span id="atualizarPagina" onclick="atualizarPagina()">üîÑ</span>
        <h2>calculo completo de</h2>
        <input type="number" id="valorInput" value="15" min="0" max="100" step="5" placeholder="15">%
    </div>

    <div id="contador-taxas">Taxas aplicadas 0 vezes</div>
    <button type="button" onclick="inverterTaxas()">Remover Taxas</button>
    <label for="taxa">Taxas (%):</label>
    <input type="number" id="taxa" value="10" min="0" max="100" step="1">
    <button type="button" onclick="aplicarTaxas()">Aplicar Taxas</button>
    <button id="meuBotao" type="button" onclick="calcular()">Calcular Totais</button>

    <table>
        <thead>
            <tr>
                <th>Categoria</th>
                <th>Dias 1</th>
                <th>Valor 1</th>
                <th>Dias 2</th>
                <th>Valor 2</th>
                <th>Dias 3</th>
                <th>Valor 3</th>
                <th>Dias 4</th>
                <th>Valor 4</th>
                <th>Total</th>
                <th>Desconto (%)</th>
                <th>Com Desconto</th>
            </tr>
        </thead>
        <tbody>
            <tr>
                <td>Simples</td>
                <td><input type="number" id="simples-qtd1" value="1" min="0">x</td>
                <td>$<input type="number" id="simples-valor1" value="100" min="0" step="0.01"></td>
                <td><input type="number" id="simples-qtd2" value="1" min="0">x</td>
                <td>$<input type="number" id="simples-valor2" value="0" min="0" step="0.01"></td>
                <td><input type="number" id="simples-qtd3" value="1" min="0">x</td>
                <td>$<input type="number" id="simples-valor3" value="0" min="0" step="0.01"></td>
                <td><input type="number" id="simples-qtd4" value="1" min="0">x</td>
                <td>$<input type="number" id="simples-valor4" value="0" min="0" step="0.01"></td>
                <td class="resultado" id="simples-total">R$ 0,00</td>
                <td><input type="number" id="simples-desc-perc" value="15" min="0" max="100" step="5">%</td>
                <td class="resultado" id="simples-desc">R$ 0,00</td>
            </tr>
            <tr>
                <td>M√©dio</td>
                <td><input type="number" id="medio-qtd1" value="1" min="0">x</td>
                <td>$<input type="number" id="medio-valor1" value="100" min="0" step="0.01"></td>
                <td><input type="number" id="medio-qtd2" value="1" min="0">x</td>
                <td>$<input type="number" id="medio-valor2" value="0" min="0" step="0.01"></td>
                <td><input type="number" id="medio-qtd3" value="1" min="0">x</td>
                <td>$<input type="number" id="medio-valor3" value="0" min="0" step="0.01"></td>
                <td><input type="number" id="medio-qtd4" value="1" min="0">x</td>
                <td>$<input type="number" id="medio-valor4" value="0" min="0" step="0.01"></td>
                <td class="resultado" id="medio-total">R$ 0,00</td>
                <td><input type="number" id="medio-desc-perc" value="15" min="0" max="100" step="5">%</td>
                <td class="resultado" id="medio-desc">R$ 0,00</td>
            </tr>
            <tr>
                <td>Master</td>
                <td><input type="number" id="master-qtd1" value="1" min="0">x</td>
                <td>$<input type="number" id="master-valor1" value="100" min="0" step="0.01"></td>
                <td><input type="number" id="master-qtd2" value="1" min="0">x</td>
                <td>$<input type="number" id="master-valor2" value="0" min="0" step="0.01"></td>
                <td><input type="number" id="master-qtd3" value="1" min="0">x</td>
                <td>$<input type="number" id="master-valor3" value="0" min="0" step="0.01"></td>
                <td><input type="number" id="master-qtd4" value="1" min="0">x</td>
                <td>$<input type="number" id="master-valor4" value="0" min="0" step="0.01"></td>
                <td class="resultado" id="master-total">R$ 0,00</td>
                <td><input type="number" id="master-desc-perc" value="15" min="0" max="100" step="5">%</td>
                <td class="resultado" id="master-desc">R$ 0,00</td>
            </tr>
        </tbody>
    </table>

    <div id="resultado-final"></div>
    <button onclick="copiarTexto('resultado-final')">Copiar Totais</button>
    <div id="resultado-descontos"></div>
    <button onclick="copiarTexto('resultado-descontos')">Copiar Descontos</button>
    <div id="alerta-copiar" style="display: none; position: fixed; top: 20px; right: 20px; background-color: #4caf50; color: white; padding: 10px; border-radius: 5px; box-shadow: 0px 4px 6px rgba(0,0,0,0.1); z-index: 1000;">
        Texto copiado!
    </div>
    <div id="alerta-calculo" style="display: none; position: fixed; top: 20px; right: 20px; background-color: #4caf50; color: white; padding: 10px; border-radius: 5px; box-shadow: 0px 4px 6px rgba(0,0,0,0.1); z-index: 1000;">
        <!-- Calculado! -->
    </div>
    <script>
        const valorInput = document.getElementById('valorInput');
                const simplesDesc = document.getElementById('simples-desc-perc');
                const medioDesc = document.getElementById('medio-desc-perc');
                const masterDesc = document.getElementById('master-desc-perc');

                // Inicializa os valores com 15
        simplesDesc.value = 15;
        medioDesc.value = 15;
        masterDesc.value = 15;

        // Atualiza os campos ao digitar no input
        valorInput.addEventListener('input', () => {
            const valor = parseFloat(valorInput.value) || 0;
            
            simplesDesc.value = (valor).toFixed(0);
            medioDesc.value = (valor).toFixed(0);
            masterDesc.value = (valor).toFixed(0);
        });


        document.addEventListener('DOMContentLoaded', () => {
        atualizarCoresDosValores();
        atualizarCorDescontoPercentual();
        atualizarCorContadorTaxas();

        // Eventos para atualizar as cores dinamicamente
        const inputsDeValores = document.querySelectorAll('input[type="number"]');
        inputsDeValores.forEach(input => {
            input.addEventListener('input', () => {
                atualizarCoresDosValores();
                atualizarCorDescontoPercentual();
            });
        });

        const inputTaxa = document.getElementById("taxa");
        inputTaxa.addEventListener("input", atualizarCorContadorTaxas);
    });

    // Atualiza as cores dos valores (verde e vermelho)
    function atualizarCoresDosValores() {
        const categorias = ["simples", "medio", "master"];

        categorias.forEach(categoria => {
            for (let i = 1; i <= 4; i++) {
                const valorInput = document.getElementById(`${categoria}-valor${i}`);
                const valorAtual = parseFloat(valorInput.value) || 0;

                if (valorAtual > 0) {
                    valorInput.style.color = 'green'; // Verde para valores acima de 0
                } else {
                    valorInput.style.color = 'red'; // Vermelho para valores iguais a 0
                }
            }
        });
    }

    // Atualiza as cores dos descontos percentuais (10%)
    function atualizarCorDescontoPercentual() {
        const categorias = ["simples", "medio", "master"];

        categorias.forEach(categoria => {
            const descontoPercentualElem = document.getElementById(`${categoria}-desc-perc`);
            if (descontoPercentualElem) {
                descontoPercentualElem.style.color = 'purple'; // Define a cor roxa para o percentual de desconto
            }
        });
    }

    // Atualiza a cor do contador de taxas (vermelho para 0, verde para 1 ou mais)
    function atualizarCorContadorTaxas() {
        const contadorElem = document.getElementById("contador-taxas");
        const taxaAplicada = parseInt(contadorTaxas) || 0;

        if (taxaAplicada === 0) {
            contadorElem.style.color = 'red'; // Vermelho quando 0
        } else {
            contadorElem.style.color = 'green'; // Verde quando 1 ou mais
        }
    }

        // campos de quantidade e valor pulando em sequencia campo em campo
        document.addEventListener('DOMContentLoaded', () => {
            // Define a sequ√™ncia personalizada de campos
            const sequence = [
                "simples-qtd1",
                "medio-qtd1",
                "master-qtd1",
                "simples-qtd2",
                "medio-qtd2",
                "master-qtd2",
                "simples-qtd3",
                "medio-qtd3",
                "master-qtd3",
                "simples-qtd4",
                "medio-qtd4",
                "master-qtd4",
                "simples-valor1",
                "medio-valor1",
                "master-valor1",
                "simples-valor2",
                "medio-valor2",
                "master-valor2",
                "simples-valor3",
                "medio-valor3",
                "master-valor3",
                "simples-valor4",
                "medio-valor4",
                "master-valor4"
            ];

            // Adiciona o evento keydown a cada campo da sequ√™ncia
            sequence.forEach((id, index) => {
                const input = document.getElementById(id);
                if (input) {
                    input.addEventListener('keydown', (event) => {
                        if (event.key === 'Enter') {
                            event.preventDefault(); // Previne o comportamento padr√£o do Enter
                            const nextIndex = (index + 1) % sequence.length; // Move para o pr√≥ximo campo, ciclando
                            const nextInput = document.getElementById(sequence[nextIndex]);
                            if (nextInput) {
                                nextInput.focus(); // Foca no pr√≥ximo campo
                                nextInput.select(); // Seleciona o conte√∫do do pr√≥ximo campo
                            }
                        }
                    });
                }
            });
        });


          // Vari√°vel global para contar o n√∫mero de vezes que as taxas foram aplicadas
        let contadorTaxas = 0;

        function aplicarTaxas() {
            const taxaPercentual = parseFloat(document.getElementById("taxa").value) || 0;
            const categorias = ["simples", "medio", "master"];

            categorias.forEach(categoria => {
                for (let i = 1; i <= 4; i++) {
                    const valorInput = document.getElementById(`${categoria}-valor${i}`);
                    const valorAtual = parseFloat(valorInput.value) || 0;
                    const valorComTaxa = valorAtual + (valorAtual * (taxaPercentual / 100));
                    valorInput.value = valorComTaxa.toFixed(2);
                }
            });

            // Incrementa o contador e exibe
            contadorTaxas++;
            document.getElementById("contador-taxas").innerText = `Taxas aplicadas ${contadorTaxas} vezes`;
            atualizarCorContadorTaxas(); // Atualiza a cor do contador
        }

        function inverterTaxas() {
            const taxaPercentual = parseFloat(document.getElementById("taxa").value) || 0;
            const divisor = 1 + (taxaPercentual / 100);

            ["simples", "medio", "master"].forEach(categoria => {
                for (let i = 1; i <= 4; i++) {
                    const valorInput = document.getElementById(`${categoria}-valor${i}`);
                    const valorAtual = parseFloat(valorInput.value) || 0;
                    const valorOriginal = valorAtual / divisor;
                    valorInput.value = valorOriginal.toFixed(2);
                }
            });

            // Decrementa o contador e atualiza a exibi√ß√£o
            contadorTaxas--;
            document.getElementById("contador-taxas").innerText = `Taxas aplicadas ${contadorTaxas} vezes`;
            atualizarCorContadorTaxas(); // Atualiza a cor do contador
        }
        
        function calcular() {
            const categorias = ["simples", "medio", "master"];
            let resultadoTotais = "";
            let resultadoDescontos = "";

             // Pega o valor do input de desconto
            const descontoPercentual = parseFloat(document.getElementById('valorInput').value) || 0;

            // L√≥gica de c√°lculo (pode ser implementada aqui)
            const alerta = document.getElementById('alerta-calculo');

            // Exibe o alerta com a porcentagem de desconto
            alerta.innerHTML = `Calculado! ${descontoPercentual}%`;

            // Mostrar alerta
            alerta.style.display = 'block';

            // Ocultar alerta ap√≥s 1 segundo
            setTimeout(() => {
                alerta.style.display = 'none';
            }, 1000);

            // Fun√ß√£o para formatar em reais
            const formatarReal = (valor) => {
                return new Intl.NumberFormat('pt-BR', { style: 'currency', currency: 'BRL' }).format(valor);
            };

            categorias.forEach(categoria => {
                let total = 0;
                let totalComDesconto = 0;
                let descontoPercentual = parseFloat(document.getElementById(`${categoria}-desc-perc`).value) || 0;
                let detalhes = ""; // Armazena os detalhes v√°lidos para exibi√ß√£o
                let esgotado = true; // Flag para verificar se todos os valores s√£o zero

                for (let i = 1; i <= 4; i++) {
                    const qtd = parseFloat(document.getElementById(`${categoria}-qtd${i}`).value) || 0;
                    const valor = parseFloat(document.getElementById(`${categoria}-valor${i}`).value) || 0;

                    if (qtd > 0 && valor > 0) { // Apenas considera valores v√°lidos
                        esgotado = false; // Se houver valores v√°lidos, n√£o est√° esgotado
                        detalhes += `${qtd}x${formatarReal(valor)} + `;
                        total += qtd * valor;
                    }
                }

                if (esgotado) {
                    resultadoTotais += `${categoria.charAt(0).toUpperCase() + categoria.slice(1)}: Esgotado\n`;
                    document.getElementById(`${categoria}-total`).innerText = "Esgotado";
                    document.getElementById(`${categoria}-desc`).innerText = "-";
                } else {
                    detalhes = detalhes.slice(0, -3); // Remove o √∫ltimo "+"
                    totalComDesconto = total - (total * (descontoPercentual / 100));

                    resultadoTotais += `${categoria.charAt(0).toUpperCase() + categoria.slice(1)}: ${detalhes} = ${formatarReal(total)}\n`;
                    resultadoDescontos += `${formatarReal(total)} *-${descontoPercentual}%* = ${formatarReal(totalComDesconto)}\n`;

                    // Atualiza os campos na tabela
                    document.getElementById(`${categoria}-total`).innerText = formatarReal(total);
                    document.getElementById(`${categoria}-desc`).innerText = formatarReal(totalComDesconto);
                }
            });

            document.getElementById("resultado-final").innerText = resultadoTotais || "Nenhuma categoria v√°lida.";
            document.getElementById("resultado-descontos").innerText = resultadoDescontos || "Nenhum desconto aplic√°vel.";
        }


        function copiarTexto(elementoId) {
            const elemento = document.getElementById(elementoId);
            const texto = elemento.innerText;

            if (texto.trim() !== "") {
                navigator.clipboard.writeText(texto)
                    .then(() => {
                        exibirAlerta("Texto copiado!");
                    })
                    .catch(err => {
                        console.error("Erro ao copiar texto: ", err);
                    });
            } else {
                exibirAlerta("Nada para copiar!");
            }
        }

        function exibirAlerta(mensagem) {
            const alerta = document.getElementById("alerta-copiar");
            alerta.innerText = mensagem;
            alerta.style.display = "block";

            // Oculta o alerta ap√≥s 1 segundo
            setTimeout(() => {
                alerta.style.display = "none";
            }, 1000);
        }

        function atualizarPagina() {
            location.reload(); // Atualiza a p√°gina
        }

    </script>
</body>
</html>
